package jumo.mlp;

import dataRecording.DataTuple;
import jumo.utility.neural.NeuralNetwork;
import pacman.controllers.Controller;
import pacman.game.Constants.MOVE;
import pacman.game.Game;

public class JumoMLP  extends Controller<MOVE> {
	private NeuralNetwork nn;
	
	private double[][] weights = {
			{ -0.9944700864889799, 0.8985164606687936, 0.5658248875779353, -0.26235849848517123, -0.670008357492754, -0.906015046050008, 0.3699202465716467, 0.5923825211635749, 0.1683845968851969, 0.8661546643903819, 0.9770524400820357, -0.9913813324716749, -0.5794696062676528, 0.3963546602386092, 0.01157935236998986, 0.4687516170006596, -0.6592737594168654, 0.4612096933995853, 0.9472191265158914, 0.6058619065452573, 0.3164514978799844, -0.9392438114044921, 0.4116976588782344, 0.464310438196917, -0.25342122561411395,  },
			{ 0.2259732349420256, -0.3682971648745008, -0.3229099927339316, -0.9417870455184274, 0.26994952016972706, -0.8323803722192789, 0.9110619907005078, -0.36238992741865905, 0.0613603960340825, -0.894899138033542, 0.7769167875832999, -0.750544639277337, 0.7758827846473917, -0.04939656715258689, 0.8088992443717367, 0.38010890214424964, -0.9793717923609526, 0.620600558637586, -0.9099564164862659, 0.8642546990980726, -0.7713721004343053, -0.8807430346350498, 0.6318663451207371, -0.8592830085711756, 0.7848565782811621,  },
			{ 0.7669331446475742, 0.7131671201629954, -0.4679633285750624, 0.47223507419989774, 0.17196256298476476, 0.04079189709026432, -0.9462719329011284, -0.4844954484178037, 0.5307231524004565, -0.18408407345628164, 0.4329640283325771, 0.752818931925165, -0.7038959189112559, 0.5726063032382562, 0.2527671747847815, -0.7206457173790379, 0.7720455033991116, -0.9988724603530308, 0.43661055617049627, -0.7158116432454633, -0.22809239135763315, -0.12334311133989417, -0.3503378241041837, 0.7411550064551349, 0.12100365222805598,  },
			{ -0.3152211301735133, 0.6167332747615466, 0.11633295206530914, -0.5112905672653623, 0.5683319456391127, -0.15667987487058976, -0.6807199157419646, -0.1968598140328699, -0.18411723734302554, -0.2250437453781693, 0.7520785003371899, 0.3314630455130656, -0.7296925007291379, 0.04142106185585326, -0.5002912999448377, 0.4014933006961816, 0.7566623097621381, 0.10617762197552927, 0.4572234327459843, 0.6952979185444976, -0.08827211205347973, 0.37774181561194853, 0.5036459342630633, 0.0631111536899509, -0.3566833260693931,  },
			{ 0.638512877064177, -0.2905300061627947, 0.8859424492576669, -0.14436578913946918, -0.49207798384469603, -0.9959076451183404, 0.15783666359707893, 0.047689489277108255, 0.5805869136424309, 0.7314610521409188, -0.3361760315889606, -0.07504842708507087, -0.1335151661929581, -5.82424674415705, -1.216740631132335, -5.132443550034236, -7.725522185872923, 0.5449662719696196, 1.1252654629173715, -0.08117925746391925, -8.267740017894225, -407.68605393521284, -436.1640936314134, -673.5573566441844, -423.25189936333675,  },
			{ 0.5494207415220966, 0.12933748955400337, -0.46071593968779423, -0.3653198028239024, -0.058749840665258235, -0.6396831384699124, 0.9718131231662406, 0.6392738051739291, 0.8964540100873166, -0.8240589414311124, -0.25045681867152525, 0.5347848595452587, 0.42105894019168844, -9.80792736535725, 9.97183077940777, -9.513327566324893, -9.223736806431265, -1.8099273452747449, -2.9154775396066244, -1.8376717930652926, -5.149195120951458, -48.97776842885057, -19.538279278241397, -472.98380041559335, -1015.8682031484556,  },
			{ 0.11247985662876192, -0.17794412689611416, 0.8915052935588821, -0.5741509756183358, -0.744939453403562, 0.20585530222398263, -0.33514191963502804, -0.271364985403858, -0.28161521134331746, -0.12538863875141404, -0.7569128553732594, 0.7601269729752573, -0.03554843858291168, 2.506752896580212, -9.356601717337098, 6.508766697230111, 7.878950291492136, -2.809714868183752, 5.98113401657947, -6.3560769557014485, 6.651866059207477, -281.3523943368911, 2.55994499900723, -645.9548745606506, -1593.610297883006,  },
			{ 0.8300198878751261, -0.2823401181707337, -0.9062157180250232, -0.8943835112164387, -0.12598017240943404, -0.34614389749968644, 0.7261102393917747, 0.3780410909470484, -0.10095772895834831, -0.4526282665609691, 0.35422165586118126, 0.46593460815760523, 0.9144919908624405, 5.548205754470683, -5.306234743634524, -9.491411313624372, 0.5919953866815868, -3.6916381225701826, -7.20305258116104, 2.5803838256760825, 6.768866950807514, -187.19531891458539, -283.6406999394655, -256.8157257358307, -1243.0091501770326,  },
			{ -0.07928127006235486, 0.8203315588332218, -0.6882285434608348, 0.8619861959966615, 0.1227390469586882, -0.24557334370982753, 0.6588422311133468, -0.4622863803799486, 0.3087918552361433, -0.5722688777083691, 0.733846844179022, 0.7609673617124924, 0.7839732139028439, -0.6487259990261398, 0.5223340674197481, -0.7637736159537429, -0.2753614437975347, 0.610296190378206, 0.42111882003922063, -0.9519143543449706, 0.6399134182005823, -0.8346864377905023, 0.9464981707802442, -0.568708914741884, 0.890838495695456,  },
			{ -0.2512675552610022, 0.5897314850266153, 6.158259626718454E-4, 0.6851787870517025, -0.5936048256054898, -0.5893334063673357, 0.13936864439336705, 0.8272551052942401, -0.82711402114816, -0.8970290498943232, -0.7839708334591409, -0.5740168735075775, -0.6286190001533793, 0.4695061694352338, 0.8317078115294485, 0.7506350025950761, 0.593279277545177, -0.48603922939504196, -0.6031686024823371, -0.5273341973903896, 0.5398047750079129, -0.3150643658760637, 0.9936579682957514, 0.64327412994526, 0.5972220673744313,  },
			{ 0.20125385412666663, 0.7019286723774962, -0.06980301924324728, -0.7307374599180407, 0.8423448879904218, -0.65183365441781, -0.12643577187337107, 0.4048098103841824, 0.10513188698423215, -0.015165626978600022, 0.21946832171326314, 0.5358471962238895, 0.20892778935735867, 0.31377263562596625, -0.24876843278057614, -0.4198773489626755, -0.9275747611080207, -0.2609705373609852, -0.5378173746348929, 0.6649398080979971, 0.0919424418784196, 0.7674130911393178, 0.4000805795835878, -0.1070630817127789, -0.682333835930024,  },
			{ 0.07078822946057928, 0.06215469804007201, -0.502330734234135, 0.4547102625316688, 0.6823464202078777, 0.8310547195196067, 0.026261739254285876, -0.9916128292965987, -0.48021711876672035, 0.6158355184653519, 0.9383542220974035, -0.15183302743032567, -0.2884853723951224, 3.483761423554939, 1.4869875417358205, -0.9678834682853273, -1.1682712281864185, 2.7318509339957515, 2.140895917720385, 1.8295980126881817, 0.15523922507844368, -10.536492783050635, -2.837648396911962, -57.65061000212171, 0.8186190562517415,  },
			{ -0.7364792296183844, -0.40916863049234786, 0.2296299692663244, 0.30344591601071835, -0.34233254492211196, -0.04949109347481584, -0.7276450979761506, -0.5303952782384183, 0.4737088337764679, -0.4058280385472357, 0.7155127877864464, 0.9630891707378164, -0.9994823499036107, -2.6739714964250885, 2.572295961976669, -5.551686639253408, -6.01264382116983, 1.2412003530019808, 4.0891477894097035, -0.32630322597791966, -2.6396048042963605, -236.22263253539822, -95.68776066584297, 104.01396465303104, 660.8081832469522,  },
			{ 0.772382999747623, 0.9109558727583411, -0.2504951881865247, 0.8793928914888858, -0.3692334285678418, -0.49438315837703817, 0.15884261260790633, 0.8801937824110013, -0.890569650483716, 0.968440465925668, 0.47545689165905936, 0.21953548146906, 0.16617485520957787, -18.6546145515066, -21.344931278793116, 11.262110341547974, -3.8475208021933733, -12.054018299000722, -5.259768358988251, -1.91151917820183, -13.29136268896491, -0.25817328696574027, 0.42523738509650816, 0.18541865400327223, -0.44556868847874015,  },
			{ -0.2866686280997577, -0.09430133783013628, -0.6739746686833477, -0.15535718225424677, -0.9888656663507849, -0.878832288998018, -0.562892398524663, -0.5156981379913597, -0.9247543612859563, -0.3206331350254845, 0.10131902734411136, -0.07036051324723025, 0.1603446372561408, -2.1821830998001346, -2.1359802070715928, -4.057518520045801, -1.9707237879163781, -2.31134213058863, -1.819206138452524, 1.8416746932797583, -2.175837895154247, -1.9567330318814187, -9.814186234337797, -1.078465141409912, 2.178456660165223,  },
			{ -0.014164591493199818, -0.17983624716873958, -0.11797442168321437, -0.49438549869870907, -0.7900341923905343, 0.9731126660212017, -0.051467419212195775, -0.4942150521978306, 0.8530166646918209, 0.12913577775107288, 0.821103422617459, 0.33518392914968187, -0.6774401966039196, -12.333018075967301, 6.759695242963161, -6.235800378714303, 0.5501920797405786, -1.7453543478923563, 7.554304535426561, -1.2565707348875579, -7.341746323989003, 6.776740050429684, 0.16360808266902555, -5.581503683399578, -7.231638069700782,  },
			{ -0.46960234901905085, 0.7848501137802395, -0.9012362122302255, -0.6903686627090391, -0.8573095156453123, 0.2277598489235544, -0.5327395483696624, -0.01217369492425524, -0.2881950831459188, 0.6571417635705825, -0.3435448675577424, -0.2626407485508868, -0.322586956667158, -4.6419649310841935, 4.552883341062101, 4.002411268010884, -13.41631047875779, 4.9057858781896595, 5.017049532978053, 2.258495225685292, 11.253928338870207, -1.725410071275689, -3.0005781567438885, -0.10095551962425424, 3.2792652507644298,  },
			{ -0.2128169377123852, -0.8816329739842077, -0.8289927265287098, 0.872894484464984, -0.8609468650126628, 0.020985741573125383, 0.9697642534719342, -0.5827459776086166, -0.03420406195371317, 0.9570916915018433, -0.8011474312564089, -0.357982110072957, -0.5461517107154985, -3.1996910419297353, -1.3215717414451005, -0.15847365325375, -1.3706271511408348, -0.8221928709121019, 1.3768240606599917, -1.8394543790809919, -0.5266691634003245, 1.8413790224450834, -0.9269539694257862, -3.143976772036766, 1.624928623800662,  },
			{ 0.8671292746372103, 0.39440757991948416, 0.11881829051898851, 0.914116074896308, -0.5839292971351251, -0.150337397593314, -0.6375520270043098, -0.853126975912408, 0.5129664712554305, 0.3625356498788521, 0.7439882695362334, -0.5346116132931706, 0.3954723213311524, -14.848363893596817, 8.827230754681993, 1.73276757121187, -0.7660388726220874, 0.8129931082774645, -10.39789469661188, -2.6145167018159334, -7.244737408092798, -2.602238473222114, 1.4788778418263824, 0.7115581826305994, 1.1922479467525455,  },
			{ 0.08366074893451225, -0.11128261208855683, 0.148587398880073, 0.9759630851539634, 0.4759590619651324, 0.47062724290399816, -0.9877500889931214, -0.04645772356225342, -0.11177072978202784, 0.7739703786669463, -0.7333370583163958, 0.9351624396234015, -0.6625374924144878, -0.2479771641068889, -1.1792999050437598, -0.4215285928160446, -1.9457727344682896, 0.9345415416610641, 0.3456260413767587, -0.1519365472426942, -2.0284555523357564, -4.1453976699144315, -0.09239726025199083, 2.381256468880356, 1.4862480722060758,  },
			{ -2.783046193679528E-4, 0.7758777433334962, 0.37378356486823217, -0.7366970657386676, 0.8067933968648497, 0.8546198332450712, -0.5285279438685084, 0.025274770317628814, -0.2177991671268924, 0.5829450018526345, 0.697967673303223, -0.7499807464386592, 0.23217680498201942, -1.9023443677806346, -0.9340334294864254, -3.370890313975983, 0.01939793378783966, -1.3251431824977584, 2.5381744187839748, 0.13251883998628194, 2.372178650715716, 0.20955316376041364, 0.5207445096845058, 0.448578014167112, -1.591500907207404,  },
			{ 0.9639801594322142, -0.3676072228361391, -0.6295366878520547, -0.2976208117309309, 0.6931189951739076, 0.41708726764609105, 0.9234374917166039, 0.6364652386672955, -0.4048540548409061, -0.8034198921844755, -0.47315731273410044, -0.5208382280829602, -0.17462722098572847, -69.58243478635241, 32.77280373564781, 102.55795110937976, 56.89298993561879, 40.01479865633407, -12.782255478797875, 24.258567284731132, 19.248448626334998, -277.6346227383605, -315.5818515109321, -190.45772508416889, -26.95474050244231,  },
			{ -0.31487319407504666, -0.9390238575616672, 0.8800405219689786, 0.8442701785712403, -0.1362890261160885, -0.8070441774742951, -0.4471648215652613, -0.6462839947348638, 0.4521307260819962, 0.9672976265297875, -0.3732378913923904, -0.9976360501530892, 0.3048482983440306, -171.74014309820248, -14.246930048153045, 96.02871917133864, 51.64762787347001, 28.581371782311155, 25.011808995580154, -14.387907188573939, -32.258345397816186, 387.62334351743766, -385.4687291896532, -514.6464200915617, -222.7045362796561,  },
			{ -0.48003188733329183, 0.28950820635277497, 0.4666815730543974, 0.22973410353744872, 0.737173420689234, -0.9398791264596433, 0.045205700704857854, -0.6193913699208389, -0.1447768525392017, 0.7554754837615676, -0.029983107440316514, 0.9743252158488005, 0.41845596666610874, 135.18837712726102, -43.16204026712762, -72.84234391039263, -42.021854680115, -57.77071124506187, 44.598125167799225, -21.56725139366158, 8.11341403762067, -69.30321752449713, 408.19545290121926, -192.4755055741311, 93.62344129612225,  },
			{ 0.8654366816332637, -0.7720620850833564, -0.4566084176231098, 0.38119150478530694, 0.358977364513839, 0.00992602436473522, -0.14286315706013353, -0.7462162542621178, 0.035797271374859996, -0.5256203044829204, -0.7517439794600005, 0.7182605119507666, 0.5617663244556568, 31.334181825512427, 33.17997687014135, 28.123751259690934, 50.52144662576511, 0.22897408166144023, -86.34899202339295, 2.0563729644342614, 44.608639700671475, 120.35112307422057, -243.2929127291144, 240.81974140392103, -368.9188023844575,  },
		};
	
	double[] biases = {
			0.7421212954832654, 0.43617615402395415, -0.680020221387049, 0.5366012499856445, 0.9091448102854147, -0.7059580897976179, -0.4388148997421504, 0.7101902338795214, -0.257896705685998, -0.6837642990815638, -0.4568025317322031, -0.056446501384015635, 0.10766720656618967, -0.9922621946444311, -6.982546950083802, -3.7504559316917483, -6.09063945419149, -5.366924942261703, -6.390763812802595, -3.6456094488402337, -9.543295917983977, -0.7698870540345655, 0.2889448521120608, -2.2958409530002513, -2.139004447661989, 
		};
			
	int numInput = 13;
	int numHidden = 8;
	int numOutput = 4;

	
	public JumoMLP() {
		nn = new NeuralNetwork(numInput, numHidden, numOutput, weights, biases);
	}
	
	@Override
	public MOVE getMove(Game game, long timeDue) {
		DataTuple dt = new DataTuple(game, MOVE.NEUTRAL);
		
		return BestMove(nn.forward(dt.nnInputs()));
	}

	private MOVE BestMove(NeuralNetwork nn) {
		double[] outputs = nn.output();
		
		int bestIndex = -1;
		double bestValue = Double.NEGATIVE_INFINITY;
		
		for (int i = 0; i < outputs.length; i++) {
			if (outputs[i] > bestValue) {
				bestValue = outputs[i];
				bestIndex = i;
			}
		}
		
		if (bestIndex == 0) { return MOVE.UP; }
		if (bestIndex == 1) { return MOVE.RIGHT; }
		if (bestIndex == 2) { return MOVE.DOWN; }
		return MOVE.LEFT; // i == 3
	}
}